(this.webpackJsonpclient_user_el_gaucho_nyheter=this.webpackJsonpclient_user_el_gaucho_nyheter||[]).push([[0],{183:function(e,t,a){e.exports=a(244)},188:function(e,t,a){},244:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),s=a(42),o=a.n(s),l=(a(188),a(9)),i=a.n(l),u=a(13),m=a(32),p=a(256),d=a(261),b=a(264),E=a(43),f=a.n(E),g=a(37),h=a(161);n="https://api-el-gaucho-nyheter.herokuapp.com";var v=new(a.n(h).a)({host:n,prefixUrl:"/api/v1"}),y=function(){var e=Object(u.a)(i.a.mark((function e(t,a,n){var r,c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,r=t.target.email.value,c=t.target.password.value,e.next=6,v.signIn(r,c);case 6:s=e.sent,a({type:"AUTHENTICATE",payload:{authenticated:s.success,currentUser:s.data}}),n.replace({pathname:"/"}),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",e.t0.response.data.errors[0]);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,a,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(u.a)(i.a.mark((function e(t,a,n){var r,c,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,r=t.target.email.value,c=t.target.password.value,s=t.target.password_confirmation.value,e.next=7,v.signUp({email:r,password:c,password_confirmation:s});case 7:o=e.sent,a({type:"AUTHENTICATE",payload:{authenticated:o.data.success,currentUser:o.data.data}}),n.push("/",{message:"Registration successful, now you have access to El-gaucho mobile app. Visit your appstore!"}),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",e.t0.response.data.errors.full_messages[0]);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),j=function(){var e=sessionStorage.getItem("J-tockAuth-Storage");return e=JSON.parse(e),e=Object(g.a)(Object(g.a)({},e),{},{"Content-type":"application/json",Accept:"application/json"})},O={index:function(e){return Object(u.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e){t.next=7;break}return t.next=4,f.a.get("/articles/?category=".concat(e));case 4:a=t.sent,t.next=10;break;case 7:return t.next=9,f.a.get("/articles");case 9:a=t.sent;case 10:return t.abrupt("return",a.data.articles);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",t.t0.response.data.error);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},show:function(e,t){return Object(u.a)(i.a.mark((function a(){var n;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!t){a.next=7;break}return a.next=4,f.a.get("/articles/".concat(e),{headers:j()});case 4:n=a.sent,a.next=10;break;case 7:return a.next=9,f.a.get("/articles/".concat(e));case 9:n=a.sent;case 10:return a.abrupt("return",n.data.article);case 13:return a.prev=13,a.t0=a.catch(0),a.abrupt("return",a.t0.response.data.error);case 16:case"end":return a.stop()}}),a,null,[[0,13]])})))()}},x=a(10),k=a(260),S=a(168),C=a(11),I=function(e){var t=e.article;return c.a.createElement(c.a.Fragment,null,c.a.createElement(k.a,{as:C.b,to:"/articles/".concat(t.id),"data-cy":"article-"+t.id,id:"cards"},t.image&&c.a.createElement(S.a,{"data-cy":"image",src:t.image}),c.a.createElement(k.a.Content,null,c.a.createElement(k.a.Header,null,t.title),c.a.createElement(k.a.Description,null,t.lead))))},U=function(){var e=Object(r.useState)([]),t=Object(m.a)(e,2),a=t[0],n=t[1],s=Object(x.i)().category,o=Object(r.useState)(),l=Object(m.a)(o,2),E=l[0],f=l[1],g=Object(x.h)();return Object(r.useEffect)((function(){(function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n,e.next=3,O.index(s);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[s]),Object(r.useEffect)((function(){g.state&&f(g.state.message)}),[g]),c.a.createElement(c.a.Fragment,null,c.a.createElement(p.a,{id:"message-container"},E&&c.a.createElement(d.a,{"data-cy":"message",color:"green"},E)),c.a.createElement(p.a,{className:"articles-container"},c.a.createElement(b.a,null,c.a.createElement(b.a.Row,{columns:4},a.map((function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(I,{article:e}))}))))))},_=a(265),P=a(266),R=a(262),T=a(19),A=function(){var e=Object(r.useState)({}),t=Object(m.a)(e,2),a=t[0],n=t[1],s=Object(r.useState)(""),o=Object(m.a)(s,2),l=o[0],d=o[1],E=Object(T.c)((function(e){return e.authenticated})),f=Object(T.c)((function(e){return e.currentUser})),g=Object(x.i)().id;return Object(r.useEffect)((function(){(function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.show(g,E);case 2:(t=e.sent).id?n(t):d(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[g,E]),c.a.createElement(c.a.Fragment,null,l?c.a.createElement("p",{"data-cy":"error-message"},l):c.a.createElement(p.a,null,c.a.createElement(b.a,null,c.a.createElement(b.a.Row,null,c.a.createElement(b.a.Column,{width:13},c.a.createElement(_.a,{"data-cy":"title"},a.title))),c.a.createElement(b.a.Row,null,c.a.createElement(b.a.Column,{width:10},c.a.createElement("h5",null,a.lead),a.image&&c.a.createElement(S.a,{"data-cy":"image",size:"medium",src:a.image})),c.a.createElement(b.a.Column,{width:5})),c.a.createElement(b.a.Row,null,c.a.createElement(b.a.Column,{width:10},c.a.createElement("p",{"data-cy":"content"},a.content)),c.a.createElement(b.a.Column,{width:5})),a.premium&&"subscriber"!==f.role&&c.a.createElement(P.a,{color:"black",textAlign:"center"},c.a.createElement("h4",{"data-cy":"premium-message"},"This is a premium article, become a subscriber to read full content"," "),c.a.createElement(R.a,{as:C.b,to:E?"/become-subscriber":"/login",color:"red","data-cy":"subscription-button"},E?"Buy subscription":"You need to login to become subscriber")))))},B=a(258),L=a(257),N=a(267),D=a(135),F=a(169),H=a(164),K=a(91);D.a.use(F.a).use(H.a).use(K.e).init({fallbackLng:["en"],whitelist:["en","sv","sp"],interpolation:{escapeValue:!1}});var V=D.a,J=function(){var e=Object(T.c)((function(e){return e.authenticated})),t=Object(T.c)((function(e){return e.currentUser})),a=Object(N.a)().t;return c.a.createElement(B.a,{inverted:!0},c.a.createElement(B.a.Item,null,c.a.createElement("h1",{"data-cy":"header"},a("El Gaucho News")),c.a.createElement(B.a.Item,{as:C.b,to:"/","data-cy":"home",id:"login"},a("Home")),c.a.createElement(B.a.Item,{as:C.b,to:"/category/news","data-cy":"news",id:"login"},a("News")),c.a.createElement(B.a.Item,{as:C.b,to:"/category/sports","data-cy":"sports",id:"login"},a("Sports")),c.a.createElement(B.a.Item,{as:C.b,to:"/category/politics","data-cy":"politics",id:"login"},a("Politics"))),e?"subscriber"!==t.role&&c.a.createElement(B.a.Item,{as:C.b,to:"/become-subscriber","data-cy":"become-subscriber",position:"right",id:"login"},a("Become Subscriber")):c.a.createElement(B.a.Item,{as:C.b,to:"/login","data-cy":"login",position:"right",id:"login"},a("Login")),c.a.createElement(B.a.Item,null,c.a.createElement(L.a,{"data-cy":"change-language",id:"login",item:!0,text:a("Language")},c.a.createElement(L.a.Menu,null,c.a.createElement(L.a.Item,{onClick:function(){V.changeLanguage("sv")}},a("Swedish")),c.a.createElement(L.a.Item,{onClick:function(){V.changeLanguage("en")}},a("English")),c.a.createElement(L.a.Item,{onClick:function(){V.changeLanguage("sp")}},a("Spanish"))))))},W=a(259),q=function(){var e=Object(T.b)(),t=Object(x.g)(),a=Object(r.useState)(),n=Object(m.a)(a,2),s=n[0],o=n[1],l=function(){var a=Object(u.a)(i.a.mark((function a(n){var r;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.next=3,y(n,e,t);case 3:r=a.sent,o(r);case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement(p.a,null,c.a.createElement(W.a,{"data-cy":"login-form",onSubmit:l},c.a.createElement(W.a.Input,{icon:"user",iconPosition:"left",label:"Email:",placeholder:"email",name:"email",type:"email","data-cy":"email"}),c.a.createElement(W.a.Input,{icon:"lock",iconPosition:"left",placeholder:"password",label:"Password:",type:"password",name:"password","data-cy":"password"}),c.a.createElement(R.a,{"data-cy":"submit",content:"Submit",primary:!0}))),c.a.createElement(p.a,null,c.a.createElement(B.a.Item,{as:C.b,to:"/register","data-cy":"register"},"Don't have an account yet? Click here to sign up"),s&&c.a.createElement(d.a,{"data-cy":"message",color:"red"},s)))},z=function(e){var t=e.children,a=Object(T.c)((function(e){return e.authenticated}));return c.a.createElement(x.b,{render:function(){return a?t:c.a.createElement(x.a,{to:{pathname:"/login"}})}})},G=a(44),M=Object(G.injectStripe)((function(e){var t=function(){var t=Object(u.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,e.stripe.createToken();case 3:n=t.sent,e.submitPayment(n.token.id);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return c.a.createElement(p.a,null,c.a.createElement(W.a,{onSubmit:t},c.a.createElement("div",{"data-cy":"card-number"},c.a.createElement("label",null,"Card Number"),c.a.createElement(G.CardNumberElement,null)),c.a.createElement("div",{"data-cy":"card-expiry"},c.a.createElement("label",null,"Card Expiry"),c.a.createElement(G.CardExpiryElement,null)),c.a.createElement("div",{"data-cy":"card-cvc"},c.a.createElement("label",null,"Card CVC"),c.a.createElement(G.CardCVCElement,null)),c.a.createElement(R.a,{color:"blue"},"Start your subscription")))})),Y={create:function(e){return Object(u.a)(i.a.mark((function t(){var a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.a.post("/subscriptions",{stripeToken:e},{headers:j()});case 3:n=t.sent,a={success:!0,message:n.data.message},t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a={success:!1,message:t.t0.response.data.message};case 10:return t.prev=10,t.abrupt("return",a);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])})))()}},Z=function(){var e=Object(r.useState)(""),t=Object(m.a)(e,2),a=t[0],n=t[1],s=Object(T.b)(),o=Object(x.g)(),l=function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.create(t);case 2:(a=e.sent).success?(s({type:"USER_IS_SUBSCRIBER",payload:{role:"subscriber"}}),o.push("/",{message:a.message})):n(a.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,a&&c.a.createElement(d.a,{"data-cy":"message",color:"red"},a),c.a.createElement(G.Elements,null,c.a.createElement(M,{submitPayment:l})))},Q=function(){var e=Object(T.b)(),t=Object(x.g)(),a=Object(r.useState)(),n=Object(m.a)(a,2),s=n[0],o=n[1],l=function(){var a=Object(u.a)(i.a.mark((function a(n){var r;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.next=3,w(n,e,t);case 3:r=a.sent,o(r);case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return c.a.createElement(p.a,null,c.a.createElement(W.a,{"data-cy":"registration-form",onSubmit:l},c.a.createElement(W.a.Input,{"data-cy":"email",icon:"user",iconPosition:"left",label:"Email:",placeholder:"email",name:"email",type:"email"}),c.a.createElement(W.a.Input,{"data-cy":"password",icon:"lock",iconPosition:"left",placeholder:"password",label:"Password:",type:"password",name:"password"}),c.a.createElement(W.a.Input,{"data-cy":"password-confirmation",icon:"lock",iconPosition:"left",placeholder:"confirm password",label:"Confirm Password:",type:"password",name:"password_confirmation"}),c.a.createElement(R.a,{"data-cy":"submit",content:"Submit",primary:!0})),s&&c.a.createElement(d.a,{"data-cy":"message",color:"red"},s))},X=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(r.Suspense,{fallback:c.a.createElement("div",null,"Loading...")},c.a.createElement(J,null),c.a.createElement(x.d,null,c.a.createElement(x.b,{exact:!0,path:"/category/:category",component:U}),c.a.createElement(x.b,{exact:!0,path:"/articles/:id",component:A}),c.a.createElement(x.b,{exact:!0,path:"/login",component:q}),c.a.createElement(x.b,{exact:!0,path:"/register",component:Q}),c.a.createElement(z,{path:"/become-subscriber"},c.a.createElement(Z,null)),c.a.createElement(x.b,{path:"/",component:U}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(243);var $,ee=a(109),te={authenticated:!1,currentUser:{}},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTHENTICATE":return Object(g.a)(Object(g.a)(Object(g.a)({},e),t.payload),{},{role:t.payload.role});case"USER_IS_SUBSCRIBER":return Object(g.a)(Object(g.a)({},e),{},{currentUser:Object(g.a)(Object(g.a)({},e.currentUser),{},{role:t.payload.role})});default:return e}},ne=function(){return Object(ee.b)(ae)};$="https://api-el-gaucho-nyheter.herokuapp.com/api/v1",f.a.defaults.baseURL=$;var re=ne();window.store=re,o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(G.StripeProvider,{apiKey:"pk_test_51HdB6WLqoRP4iCAc86KxXieG7mYFdiNUY5VletydKDhZKC6BWEzoC13C29OGVHKMWo6dx6qTco9Kwqikcm5IOlZJ00Q1ajKLzs"},c.a.createElement(T.a,{store:re},c.a.createElement(C.a,null,c.a.createElement(X,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[183,1,2]]]);
//# sourceMappingURL=main.31974b3f.chunk.js.map